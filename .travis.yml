sudo: required

services:
  - docker

language: java

script: "mvn cobertura:cobertura"

deploy:
  provider: releases
  api_key: "24ed1be7b0c53c1c08e787a228953914e0bb928a"
  file: target/trackfind-$TRAVIS_TAG.jar
  skip_cleanup: true
  on:
    tags: true

after_success:
  - if [ -n "$TRAVIS_TAG" ]; then
    docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD";
    docker build -t dtitov/trackfind:$TRAVIS_TAG .;
    docker push dtitov/trackfind:$TRAVIS_TAG;
    fi
  - bash <(curl -s https://codecov.io/bash)